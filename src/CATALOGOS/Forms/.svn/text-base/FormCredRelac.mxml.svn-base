<?xml version="1.0" encoding="utf-8"?>
<mx:Canvas xmlns:mx="http://www.adobe.com/2006/mxml" width="550" height="240">
	
	<mx:Metadata>
		[Event(name="enviarDatosProd", type="Data.EventProd")]
	</mx:Metadata>

	<mx:Script>
		<![CDATA[
			import Data.DatosProd;
			import Data.EventProd;
			import Data.Globales;
			import Data.Utils;
			import mx.collections.ArrayCollection;
			import mx.controls.Alert;
			import mx.core.Application;
			import mx.effects.*;
			import mx.events.EffectEvent;
			import mx.managers.PopUpManager;
			import mx.rpc.soap.WebService;
			import mx.rpc.events.ResultEvent;
			
			[Bindable]
			public var formaObj:ArrayCollection;
			
			public var datos:DatosProd = new DatosProd();
			
			public var wsMS:WebService;	
			public var tipoAccion:int;
			private var global:Globales;
			private var du:Utils;
			
			public function enviarDatosProd(formData:DatosProd):void{
				if(valida()){
					formData.montoMaxRel = Number(txtMontoMax.text);
					formData.fMontoMaxRel = cboFMontoMax.selectedItem.id;
					formData.minIntRel = Number(txtMinInt.text);
					formData.fMinIntRel = cboFMinInt.selectedItem.id;
					formData.maxIntRel = Number(txtMaxInt.text);
					formData.fMaxIntRel = cboFMaxInt.selectedItem.id;
					formData.cicloRel = txtCiclo.text;
					formData.perMinRel = Number(txtPerMin.text);
					formData.perMaxRel = Number(txtPerMax.text);
					formData.guardaRelac = true;
				}
				else
					formData.guardaRelac = false;
				
				var event:EventProd = new EventProd("enviarDatosProd", formData);
				dispatchEvent(event);
			}
			
			private function formateaForma():void{
				var oItem:Object;
				var item:Array = new Array();
				
				oItem = new Object();
				oItem.id = "";
				oItem.nombre = "--Formato--";
				item.push(oItem);
				
				oItem = new Object();
				oItem.id = "N";
				oItem.nombre = "Numérico";
				item.push(oItem);
				
				oItem = new Object();
				oItem.id = "P";
				oItem.nombre = "Porcentual";
				item.push(oItem);
				
				formaObj = new ArrayCollection(item);
			}
			
			public function init(info:DatosProd, tipoAccion:int):void{
				var i:int;
				var cont:int;
				global = new Globales();
				du = new Utils();
				this.tipoAccion = tipoAccion;
				
				formateaForma();
				cboFMontoMax.dataProvider = formaObj;
				cboFMinInt.dataProvider = formaObj;
				cboFMaxInt.dataProvider = formaObj;
				
				if (info != null){
					datos = info;
					
					cont = formaObj.length;
					txtMontoMax.text = info.montoMaxRel.toString(); 
					txtMinInt.text = info.minIntRel.toString();
					txtMaxInt.text = info.maxIntRel.toString();
					for(i = 0; i < cont; i++){
						if(formaObj[i].id == info.fMontoMaxRel)
							cboFMontoMax.selectedIndex = i;
						if(formaObj[i].id == info.fMinIntRel)
							cboFMinInt.selectedIndex = i;
						if(formaObj[i].id == info.fMaxIntRel)
							cboFMaxInt.selectedIndex = i;
					}
					txtCiclo.text = info.cicloRel;
					txtPerMin.text = info.perMinRel.toString();
					txtPerMax.text = info.perMaxRel.toString();																						
				}		
			}
			
			private function valida():Boolean{
				if(txtMontoMax.text != "" && txtMontoMax.text != "0"){
					if(cboFMontoMax.selectedIndex == 0){
						return false;		
					}
				}
				if(txtMinInt.text != "" && txtMinInt.text != "0"){
					if(cboFMinInt.selectedIndex == 0){
						return false;
					}
				}
				if(txtMaxInt.text != "" && txtMaxInt.text != "0"){
					if(cboFMaxInt.selectedIndex == 0){
						return false;
					}
				}
				return true;
			}				
		]]>
	</mx:Script>
	
	<mx:Canvas id="cnvMonto" x="35.5" y="69" width="321" height="110" styleName="canvasMod">
		<mx:RadioButtonGroup id="entrega"/>
		
		<mx:TextInput id="txtMontoMax" x="119" y="10" width="60"/>
		<mx:TextInput id="txtMinInt" x="119" y="41" width="40"/>
		<mx:TextInput id="txtMaxInt" x="119" y="73" width="40"/>
		<mx:ComboBox id="cboFMontoMax" labelField="nombre" x="187" y="9" width="110"></mx:ComboBox>
		<mx:ComboBox id="cboFMinInt" labelField="nombre" x="187" y="40" width="110"></mx:ComboBox>
		<mx:ComboBox id="cboFMaxInt" labelField="nombre" x="187" y="72" width="110"></mx:ComboBox>
		<mx:Label x="35" y="12" text="Monto Máximo:" textAlign="right"/>
		<mx:Label x="14" y="43" text="Mínimo Integrantes:" textAlign="right"/>
		<mx:Label x="10" y="75" text="Máximo Integrantes:" textAlign="right"/>
	</mx:Canvas>
	<mx:Label x="35.5" y="50" text="Parámetros Relacionados"/>
	<mx:Canvas id="cnvCiclo" x="364.5" y="69" width="150" height="110" styleName="canvasMod">
		<mx:TextInput id="txtCiclo" x="101" y="10" width="30"/>
		<mx:TextInput id="txtPerMin" x="101" y="42" width="30"/>
		<mx:TextInput id="txtPerMax" x="101" y="74" width="30"/>
		<mx:Label x="35" y="12" text="Ciclo Inicio:" textAlign="right"/>
		<mx:Label x="14" y="44" text="Periodo Mínimo:" textAlign="right"/>
		<mx:Label x="10" y="76" text="Periodo Máximo:" textAlign="right"/>
	</mx:Canvas>
</mx:Canvas>
